<script>
    var dataLayer = [];
</script>

<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
            new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window, document, 'script', 'dataLayer', '{{ settings.gtm_container_id }}');</script>
<!-- End Google Tag Manager -->

<script src="{{ 'gtm.js' | asset_url }}"></script>

<script>
    {% if customer %}
    window.GTM.customer.id = {{ customer.id | json }};
    {% endif %}
    window.GTM.template.name =  {{ request.page_type | json }} == ""
        ? "checkout " + Shopify.Checkout.step
        : {{ request.page_type | json }} ;
    window.GTM.allPageEvent(Shopify.locale);
    window.GTM.currency =  Shopify.currency.active;

    window.GTM.init();
</script>